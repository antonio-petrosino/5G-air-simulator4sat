/* -*- Mode:C++; c-file-style:"gnu"; indent-tabs-mode:nil; -*- */
/*
 * Copyright (c) 2020 TELEMATICS LAB, Politecnico di Bari
 *
 * This file is part of 5G-air-simulator
 *
 * 5G-air-simulator is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 3 as
 * published by the Free Software Foundation;
 *
 * 5G-air-simulator is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with 5G-air-simulator; if not, see <http://www.gnu.org/licenses/>.
 *
 * Author: Antonio Petrosino  <antonio.petrosino@poliba.it>
 * Author: Giancarlo Sciddurlo  <giancarlo.sciddurlo@poliba.it>
 */



#ifndef BLERVSSINR_NBIoT_SAT_H
#define BLERVSSINR_NBIoT_SAT_H

#include "../../componentManagers/FrameManager.h"
#include "../../protocolStack/mac/AMCModule.h"
#include "../..//mobility/SatelliteMovement.h"
#include "../../load-parameters.h"

#include "iostream"
#include <cmath>


static double SatelliteNoisePowerDB = -149.618937;
static double TermalNoisePowerDB	= -145.983877;

static double
GetSatelliteNoisePowerDB(){
	return SatelliteNoisePowerDB;
};

static double
GetTermalNoisePowerDB(){
	return TermalNoisePowerDB;
};

static double BLER_NBIoT_SAT [27][21] =
{
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 0
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.9, 0.15, 0, 0, 0, 0, 0, 0, 0, 0, 0},// MCS = 1, NRU = 8,  NRep  = 1;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 2
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.62, 0.06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 , 0.0 }, // MCS = 3, NRU = 5,  NRep  = 1;
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.5, 0.021, 0, 0, 0, 0, 0, 0}, // MCS = 4, NRU = 4,  NRep  = 1;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 5
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.75, 0.15, 0, 0, 0, 0, 0 }, 	// MCS = 6, NRU = 3,  NRep  = 1;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 7
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.9, 0.045, 0, 0, 0 }, 	// MCS = 8, NRU = 2,  NRep  = 1;

		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 0, NRep  = 2;
		{1, 1, 1, 1, 1, 1, 1, 1, 0.9, 0.15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 1, NRU = 8,  NRep  = 2;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 2
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.49, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, // MCS = 3, NRU = 5,  NRep  = 2;
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.9, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 4, NRU = 4,  NRep  = 2;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 5
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.9, 0.25, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 6, NRU = 3,  NRep  = 2;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 7
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.5, 0.04, 0, 0, 0, 0, 0, 0 }, // MCS = 8, NRU = 2,  NRep  = 2;

		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 0, NRep  = 4;
		{1, 1, 1, 1, 1, 1, 0.9, 0.15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 1, NRU = 8,  NRep  = 4;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 2
		{1, 1, 1, 1, 1, 1, 1, 1, 0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, // MCS = 3, NRU = 5,  NRep  = 4;
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 0.95, 0.18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 4, NRU = 4,  NRep  = 4;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 5
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.85, 0.12, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 6, NRU = 3,  NRep  = 4;
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, // 7
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.95, 0.3, 0, 0, 0, 0, 0, 0, 0, 0 }, // MCS = 8, NRU = 2,  NRep  = 4;

};

static double SINR4BLER_NBIoT_SAT [27][21] =
{
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // iMCS = 0, NRep  = 1;
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 1
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 2
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 3
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 4
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 5
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 6
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 7
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 8

		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // iMCS = 0, NRep  = 2;
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 1
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 2
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0}, // 3
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 4
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 5
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 6
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 7
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 8

		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // iMCS = 0, NRep  = 4;
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 1
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 2
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0}, // 3
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 4
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 5
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 },// 6
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 7
		{-10.0, -9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0 }, // 8

};

static double SINR4CELLSELECTION_NBIoT_SAT [42] =
{
		-20, -10, -9.5 , -9, -8.5, -8, -7.5, -7, -6.5,
		-6, -5.5, -5, -4.5, -4, -3.5, -3, -2.5, -2, -1.5,
		-1, -0.5, 0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5,
		 5, 5.5,  6, 6.5, 7, 7.5,  8, 8.5,  9, 9.5, 10
};
//calcolato con 10 000 campioni
static double CELLSELECTIONPROB_NBIoT_SAT [42] =
{
		0, 0.0647, 0.0749, 0.0905, 0.0967, 0.1139, 0.1181, 0.1376, 0.1505, 0.1635,
		0.1746, 0.1981, 0.2216, 0.22, 0.2401, 0.2588, 0.2736, 0.3104, 0.3489,0.3862,
		0.4282, 0.4661, 0.5165, 0.5598, 0.6184, 0.6694, 0.7298, 0.7782, 0.8207, 0.876,
		0.9096, 0.9412, 0.9634, 0.9789, 0.9883, 0.9955, 0.9968, 1, 1, 1, 1, 1
};

static double SNR_UL_PATCH_NBIoT_SAT[584] =
{ -6.965719, -6.945163, -6.924648, -6.904176, -6.883746,
 -6.863358, -6.843012, -6.822708, -6.802446, -6.782226,
 -6.762048, -6.741912, -6.721817, -6.701765, -6.681754,
 -6.661785, -6.641857, -6.621971, -6.602127, -6.582324,
 -6.562563, -6.542843, -6.523164, -6.503527, -6.483931,
 -6.464376, -6.444862, -6.425390, -6.405959, -6.386569,
 -6.367219, -6.347911, -6.328644, -6.309418, -6.290232,
 -6.271088, -6.251984, -6.232921, -6.213898, -6.194917,
 -6.175976, -6.157075, -6.138215, -6.119396, -6.100617,
 -6.081878, -6.063180, -6.044522, -6.025904, -6.007327,
 -5.988790, -5.970293, -5.951836, -5.933419, -5.915042,
 -5.896706, -5.878409, -5.860152, -5.841935, -5.823758,
 -5.805621, -5.787524, -5.769466, -5.751448, -5.733469,
 -5.715531, -5.697631, -5.679772, -5.661951, -5.644171,
 -5.626429, -5.608728, -5.591065, -5.573442, -5.555858,
 -5.538313, -5.520807, -5.503341, -5.485914, -5.468526,
 -5.451176, -5.433866, -5.416595, -5.399363, -5.382169,
 -5.365015, -5.347899, -5.330822, -5.313784, -5.296785,
 -5.279824, -5.262902, -5.246018, -5.229173, -5.212367,
 -5.195599, -5.178869, -5.162178, -5.145525, -5.128911,
 -5.112335, -5.095797, -5.079297, -5.062836, -5.046413,
 -5.030028, -5.013681, -4.997372, -4.981101, -4.964868,
 -4.948673, -4.932516, -4.916397, -4.900315, -4.884272,
 -4.868266, -4.852298, -4.836368, -4.820475, -4.804620,
 -4.788803, -4.773023, -4.757281, -4.741576, -4.725908,
 -4.710279, -4.694686, -4.679131, -4.663613, -4.648133,
 -4.632690, -4.617284, -4.601915, -4.586583, -4.571289,
 -4.556031, -4.540811, -4.525628, -4.510482, -4.495372,
 -4.480300, -4.465264, -4.450266, -4.435304, -4.420379,
 -4.405491, -4.390639, -4.375825, -4.361046, -4.346305,
 -4.331600, -4.316932, -4.302300, -4.287705, -4.273146,
 -4.258624, -4.244138, -4.229689, -4.215275, -4.200899,
 -4.186558, -4.172254, -4.157986, -4.143754, -4.129558,
 -4.115399, -4.101275, -4.087188, -4.073136, -4.059121,
 -4.045142, -4.031198, -4.017291, -4.003419, -3.989583,
 -3.975783, -3.962019, -3.948291, -3.934598, -3.920941,
 -3.907320, -3.893734, -3.880184, -3.866670, -3.853191,
 -3.839748, -3.826340, -3.812967, -3.799630, -3.786329,
 -3.773062, -3.759831, -3.746636, -3.733476, -3.720351,
 -3.707261, -3.694206, -3.681187, -3.668202, -3.655253,
 -3.642339, -3.629460, -3.616616, -3.603807, -3.591033,
 -3.578293, -3.565589, -3.552920, -3.540285, -3.527685,
 -3.515120, -3.502590, -3.490095, -3.477634, -3.465208,
 -3.452816, -3.440460, -3.428137, -3.415850, -3.403597,
 -3.391378, -3.379194, -3.367044, -3.354929, -3.342848,
 -3.330801, -3.318789, -3.306811, -3.294868, -3.282958,
 -3.271083, -3.259242, -3.247436, -3.235663, -3.223924,
 -3.212220, -3.200550, -3.188913, -3.177311, -3.165743,
 -3.154209, -3.142708, -3.131242, -3.119809, -3.108410,
 -3.097045, -3.085714, -3.074417, -3.063153, -3.051923,
 -3.040727, -3.029564, -3.018435, -3.007340, -2.996278,
 -2.985250, -2.974255, -2.963294, -2.952366, -2.941472,
 -2.930611, -2.919784, -2.908990, -2.898229, -2.887502,
 -2.876807, -2.866147, -2.855519, -2.844925, -2.834363,
 -2.823835, -2.813340, -2.802879, -2.792450, -2.782054,
 -2.771692, -2.761362, -2.751066, -2.740802, -2.730571,
 -2.720373, -2.710209, -2.700077, -2.689977, -2.679911,
 -2.669877, -2.659876, -2.649908, -2.639973, -2.630070,
 -2.620200, -2.610363, -2.600558, -2.590786, -2.581046,
 -2.571339, -2.561664, -2.552022, -2.542412, -2.532835,
 -2.523290, -2.513778, -2.504298, -2.494850, -2.485435,
 -2.476052, -2.466701, -2.457382, -2.448096, -2.438842,
 -2.429620, -2.420430, -2.411272, -2.402146, -2.393053,
 -2.383991, -2.374962, -2.365964, -2.356999, -2.348065,
 -2.339163, -2.330294, -2.321456, -2.312650, -2.303876,
 -2.295133, -2.286423, -2.277744, -2.269097, -2.260482,
 -2.251898, -2.243346, -2.234826, -2.226337, -2.217880,
 -2.209455, -2.201061, -2.192698, -2.184367, -2.176068,
 -2.167800, -2.159564, -2.151358, -2.143185, -2.135042,
 -2.126931, -2.118852, -2.110804, -2.102786, -2.094801,
 -2.086846, -2.078923, -2.071031, -2.063170, -2.055340,
 -2.047541, -2.039773, -2.032037, -2.024331, -2.016657,
 -2.009013, -2.001401, -1.993819, -1.986269, -1.978749,
 -1.971260, -1.963802, -1.956375, -1.948979, -1.941614,
 -1.934279, -1.926975, -1.919702, -1.912460, -1.905248,
 -1.898067, -1.890917, -1.883797, -1.876708, -1.869650,
 -1.862622, -1.855624, -1.848657, -1.841721, -1.834815,
 -1.827939, -1.821094, -1.814280, -1.807496, -1.800742,
 -1.794018, -1.787325, -1.780662, -1.774030, -1.767427,
 -1.760855, -1.754313, -1.747802, -1.741320, -1.734869,
 -1.728448, -1.722057, -1.715696, -1.709365, -1.703064,
 -1.696793, -1.690552, -1.684341, -1.678161, -1.672010,
 -1.665889, -1.659797, -1.653736, -1.647705, -1.641703,
 -1.635732, -1.629790, -1.623878, -1.617995, -1.612142,
 -1.606320, -1.600526, -1.594763, -1.589029, -1.583324,
 -1.577650, -1.572005, -1.566389, -1.560803, -1.555247,
 -1.549720, -1.544222, -1.538754, -1.533316, -1.527906,
 -1.522527, -1.517176, -1.511855, -1.506564, -1.501301,
 -1.496068, -1.490865, -1.485690, -1.480545, -1.475429,
 -1.470342, -1.465284, -1.460256, -1.455257, -1.450286,
 -1.445345, -1.440433, -1.435550, -1.430696, -1.425871,
 -1.421075, -1.416308, -1.411570, -1.406861, -1.402181,
 -1.397530, -1.392908, -1.388314, -1.383749, -1.379214,
 -1.374707, -1.370228, -1.365779, -1.361358, -1.356966,
 -1.352603, -1.348268, -1.343962, -1.339685, -1.335436,
 -1.331216, -1.327024, -1.322861, -1.318727, -1.314621,
 -1.310544, -1.306495, -1.302474, -1.298482, -1.294519,
 -1.290584, -1.286677, -1.282798, -1.278948, -1.275127,
 -1.271333, -1.267568, -1.263831, -1.260123, -1.256442,
 -1.252790, -1.249166, -1.245570, -1.242003, -1.238463,
 -1.234952, -1.231469, -1.228014, -1.224587, -1.221187,
 -1.217816, -1.214473, -1.211158, -1.207871, -1.204612,
 -1.201381, -1.198178, -1.195002, -1.191855, -1.188735,
 -1.185644, -1.182580, -1.179543, -1.176535, -1.173554,
 -1.170601, -1.167676, -1.164779, -1.161909, -1.159067,
 -1.156253, -1.153466, -1.150707, -1.147975, -1.145271,
 -1.142594, -1.139946, -1.137324, -1.134730, -1.132164,
 -1.129625, -1.127113, -1.124629, -1.122173, -1.119743,
 -1.117342, -1.114967, -1.112620, -1.110300, -1.108008,
 -1.105742, -1.103504, -1.101294, -1.099110, -1.096954,
 -1.094825, -1.092723, -1.090648, -1.088600, -1.086580,
 -1.084587, -1.082620, -1.080681, -1.078769, -1.076884,
 -1.075026, -1.073194, -1.071390, -1.069613, -1.067863,
 -1.066140, -1.064443, -1.062774, -1.061131, -1.059515,
 -1.057927, -1.056365, -1.054829, -1.053321, -1.051839,
 -1.050384, -1.048956, -1.047554, -1.046180, -1.044831,
 -1.043510, -1.042215, -1.040947, -1.03970 };

static double SNR_UL_PARABOLIC_REFLECTOR_NBIoT_SAT[584] =
{ -22.300648, -22.016501, -21.740108, -21.471049, -21.208941,
 -20.953430, -20.704190, -20.460920, -20.223341, -19.991195,
 -19.764242, -19.542257, -19.325032, -19.112372, -18.904095,
 -18.700030, -18.500017, -18.303907, -18.111557, -17.922835,
 -17.737616, -17.555780, -17.377217, -17.201821, -17.029492,
 -16.860136, -16.693662, -16.529985, -16.369026, -16.210706,
 -16.054953, -15.901697, -15.750873, -15.602417, -15.456268,
 -15.312370, -15.170667, -15.031107, -14.893641, -14.758219,
 -14.624797, -14.493329, -14.363775, -14.236094, -14.110247,
 -13.986198, -13.863909, -13.743348, -13.624482, -13.507279,
 -13.391708, -13.277742, -13.165351, -13.054508, -12.945189,
 -12.837367, -12.731019, -12.626122, -12.522654, -12.420593,
 -12.319918, -12.220610, -12.122649, -12.026017, -11.930697,
 -11.836671, -11.743922, -11.652434, -11.562193, -11.473183,
 -11.385391, -11.298802, -11.213403, -11.129181, -11.046124,
 -10.964221, -10.883459, -10.803829, -10.725318, -10.647918,
 -10.571618, -10.496408, -10.422281, -10.349226, -10.277237,
 -10.206304, -10.136420, -10.067578, -9.999770, -9.932990,
 -9.867232, -9.802489, -9.738755, -9.676025, -9.614294,
 -9.553556, -9.493806, -9.435041, -9.377255, -9.320445,
 -9.264607, -9.209738, -9.155833, -9.102891, -9.050908,
 -8.999882, -8.949810, -8.900690, -8.852520, -8.805299,
 -8.759025, -8.713697, -8.669313, -8.625873, -8.583377,
 -8.541824, -8.501213, -8.461545, -8.422820, -8.385039,
 -8.348202, -8.312310, -8.277365, -8.243367, -8.210318,
 -8.178221, -8.147076, -8.116887, -8.087655, -8.059384,
 -8.032076, -8.005735, -7.980363, -7.955965, -7.932545,
 -7.910106, -7.888653, -7.868191, -7.848724, -7.830258,
 -7.812798, -7.796349, -7.780919, -7.766513, -7.753137,
 -7.740799, -7.729506, -7.719265, -7.710085, -7.701972,
 -7.694936, -7.688986, -7.684131, -7.680380, -7.677744,
 -7.676232, -7.675856, -7.676627, -7.678556, -7.681655,
 -7.685937, -7.691415, -7.698103, -7.706013, -7.715162,
 -7.725563, -7.737233, -7.750188, -7.764444, -7.780019,
 -7.796931, -7.815199, -7.834842, -7.855881, -7.878336,
 -7.902230, -7.927584, -7.954424, -7.982772, -8.012654,
 -8.044097, -8.077129, -8.111777, -8.148071, -8.186043,
 -8.225724, -8.267147, -8.310348, -8.355364, -8.402230,
 -8.450988, -8.501678, -8.554344, -8.609030, -8.665782,
 -8.724651, -8.785686, -8.848942, -8.914476, -8.982344,
 -9.052610, -9.125338, -9.200595, -9.278454, -9.358988,
 -9.442276, -9.528402, -9.617452, -9.709520, -9.804701,
 -9.903099, -10.004822, -10.109985, -10.218710, -10.331126,
 -10.447370, -10.567587, -10.691933, -10.820572, -10.953682,
 -11.091450, -11.234077, -11.381781, -11.534793, -11.693361,
 -11.857755, -12.028264, -12.205202, -12.388908, -12.579750,
 -12.778129, -12.984483, -13.199290, -13.423074, -13.656413,
 -13.899944, -14.154370, -14.420475, -14.699131, -14.991317,
 -15.298130, -15.620813, -15.960777, -16.319633, -16.699233,
 -17.101721, -17.529595, -17.985793, -18.473801, -18.997797,
 -19.562850, -20.175189, -20.842593, -21.574945, -22.385068,
 -23.290025, -24.313219, -25.487980, -26.864129, -28.521035,
 -30.596892, -33.366586, -37.515834, -45.900963, -49.728393,
 -38.647221, -33.893705, -30.811618, -28.520382, -26.692149,
 -25.168379, -23.860214, -22.712809, -21.689927, -20.766364,
 -19.923884, -19.148863, -18.430856, -17.761678, -17.134796,
 -16.544912, -15.987669, -15.459443, -14.957186, -14.478308,
 -14.020593, -13.582129, -13.161254, -12.756516, -12.366635,
 -11.990483, -11.627055, -11.275457, -10.934885, -10.604617,
 -10.284002, -9.972448, -9.669419, -9.374425, -9.087020,
 -8.806792, -8.533367, -8.266396, -8.005560, -7.750563,
 -7.501130, -7.257008, -7.017958, -6.783761, -6.554210,
 -6.329113, -6.108290, -5.891571, -5.678798, -5.469823,
 -5.264504, -5.062709, -4.864315, -4.669202, -4.477261,
 -4.288384, -4.102473, -3.919433, -3.739174, -3.561611,
 -3.386661, -3.214249, -3.044301, -2.876746, -2.711518,
 -2.548552, -2.387788, -2.229167, -2.072634, -1.918135,
 -1.765620, -1.615038, -1.466343, -1.319491, -1.174437,
 -1.031140, -0.889561, -0.749660, -0.611400, -0.474747,
 -0.339666, -0.206123, -0.074088, 0.056471, 0.185584,
 0.313278, 0.439583, 0.564523, 0.688125, 0.810414,
 0.931414, 1.051149, 1.169640, 1.286910, 1.402980,
 1.517870, 1.631600, 1.744190, 1.855658, 1.966022,
 2.075300, 2.183508, 2.290664, 2.396784, 2.501883,
 2.605976, 2.709078, 2.811203, 2.912366, 3.012579,
 3.111857, 3.210212, 3.307656, 3.404202, 3.499862,
 3.594646, 3.688567, 3.781635, 3.873862, 3.965256,
 4.055829, 4.145591, 4.234551, 4.322719, 4.410103,
 4.496714, 4.582559, 4.667647, 4.751986, 4.835586,
 4.918453, 5.000596, 5.082022, 5.162738, 5.242752,
 5.322072, 5.400703, 5.478654, 5.555929, 5.632537,
 5.708483, 5.783774, 5.858415, 5.932414, 6.005774,
 6.078504, 6.150607, 6.222089, 6.292957, 6.363214,
 6.432867, 6.501920, 6.570378, 6.638247, 6.705530,
 6.772233, 6.838361, 6.903917, 6.968906, 7.033332,
 7.097201, 7.160515, 7.223278, 7.285496, 7.347172,
 7.408309, 7.468912, 7.528984, 7.588529, 7.647550,
 7.706051, 7.764035, 7.821506, 7.878467, 7.934921,
 7.990872, 8.046323, 8.101276, 8.155735, 8.209702,
 8.263182, 8.316176, 8.368687, 8.420718, 8.472272,
 8.523352, 8.573960, 8.624098, 8.673770, 8.722978,
 8.771724, 8.820010, 8.867840, 8.915215, 8.962137,
 9.008610, 9.054634, 9.100213, 9.145349, 9.190042,
 9.234297, 9.278114, 9.321496, 9.364444, 9.406961,
 9.449048, 9.490708, 9.531941, 9.572751, 9.613138,
 9.653105, 9.692653, 9.731784, 9.770500, 9.808801,
 9.846691, 9.884170, 9.921239, 9.957902, 9.994158,
 10.030009, 10.065458, 10.100505, 10.135151, 10.169399,
 10.203249, 10.236702, 10.269761, 10.302426, 10.334699,
 10.366581, 10.398073, 10.429176, 10.459892, 10.490221,
 10.520166, 10.549726, 10.578903, 10.607698, 10.636113,
 10.664148, 10.691804, 10.719082, 10.745984, 10.772509,
 10.798660, 10.824438, 10.849842, 10.874874, 10.899535,
 10.923826, 10.947747, 10.971300, 10.994485, 11.017303,
 11.039755, 11.061841, 11.083563, 11.104921, 11.125916,
 11.146548, 11.166819, 11.186728, 11.206278, 11.225467,
 11.244298, 11.262770, 11.280884, 11.298641, 11.316041,
 11.333085, 11.349774, 11.366108, 11.382087, 11.397713,
 11.412985, 11.427905, 11.442471, 11.456686, 11.470550,
 11.484063, 11.497225, 11.510036, 11.522498, 11.534611,
 11.546375, 11.557790, 11.568857, 11.579576, 11.589948,
 11.599972, 11.609650, 11.618981, 11.627965, 11.636604,
 11.644897, 11.652844, 11.660446, 11.667703, 11.674616,
 11.681184, 11.687407, 11.693287, 11.698822, 11.704014,
 11.708862, 11.713366, 11.717527, 11.721345, 11.724820,
 11.727951, 11.730740, 11.733186, 11.735290, 11.737050,
 11.738468, 11.739543, 11.740276, 11.74066
};

static double SNR_DL_PATCH_NBIoT_SAT[584] =
{ -1.600779, -1.580223, -1.559708, -1.539236, -1.518806,
 -1.498418, -1.478072, -1.457768, -1.437506, -1.417286,
 -1.397108, -1.376972, -1.356877, -1.336825, -1.316814,
 -1.296845, -1.276917, -1.257031, -1.237187, -1.217384,
 -1.197623, -1.177903, -1.158224, -1.138587, -1.118991,
 -1.099436, -1.079922, -1.060450, -1.041019, -1.021629,
 -1.002279, -0.982971, -0.963704, -0.944478, -0.925292,
 -0.906148, -0.887044, -0.867981, -0.848959, -0.829977,
 -0.811036, -0.792135, -0.773275, -0.754456, -0.735677,
 -0.716938, -0.698240, -0.679582, -0.660964, -0.642387,
 -0.623850, -0.605353, -0.586896, -0.568479, -0.550103,
 -0.531766, -0.513469, -0.495212, -0.476995, -0.458818,
 -0.440681, -0.422584, -0.404526, -0.386508, -0.368529,
 -0.350591, -0.332691, -0.314832, -0.297011, -0.279231,
 -0.261489, -0.243788, -0.226125, -0.208502, -0.190918,
 -0.173373, -0.155867, -0.138401, -0.120974, -0.103586,
 -0.086236, -0.068926, -0.051655, -0.034423, -0.017229,
 -0.000075, 0.017041, 0.034118, 0.051156, 0.068155,
 0.085116, 0.102038, 0.118922, 0.135767, 0.152573,
 0.169341, 0.186071, 0.202762, 0.219415, 0.236029,
 0.252605, 0.269143, 0.285643, 0.302104, 0.318527,
 0.334912, 0.351259, 0.367568, 0.383839, 0.400072,
 0.416267, 0.432424, 0.448543, 0.464625, 0.480668,
 0.496674, 0.512642, 0.528572, 0.544465, 0.560320,
 0.576137, 0.591917, 0.607659, 0.623364, 0.639032,
 0.654661, 0.670254, 0.685809, 0.701327, 0.716807,
 0.732250, 0.747656, 0.763025, 0.778357, 0.793651,
 0.808909, 0.824129, 0.839312, 0.854458, 0.869568,
 0.884640, 0.899676, 0.914674, 0.929636, 0.944561,
 0.959449, 0.974301, 0.989115, 1.003894, 1.018635,
 1.033340, 1.048008, 1.062640, 1.077235, 1.091794,
 1.106316, 1.120802, 1.135251, 1.149665, 1.164041,
 1.178382, 1.192686, 1.206954, 1.221186, 1.235382,
 1.249541, 1.263665, 1.277752, 1.291804, 1.305819,
 1.319798, 1.333742, 1.347649, 1.361521, 1.375357,
 1.389157, 1.402921, 1.416649, 1.430342, 1.443999,
 1.457620, 1.471206, 1.484756, 1.498270, 1.511749,
 1.525192, 1.538600, 1.551973, 1.565310, 1.578611,
 1.591878, 1.605109, 1.618304, 1.631464, 1.644589,
 1.657679, 1.670734, 1.683753, 1.696738, 1.709687,
 1.722601, 1.735480, 1.748324, 1.761133, 1.773907,
 1.786647, 1.799351, 1.812020, 1.824655, 1.837255,
 1.849820, 1.862350, 1.874845, 1.887306, 1.899732,
 1.912124, 1.924480, 1.936803, 1.949090, 1.961343,
 1.973562, 1.985746, 1.997896, 2.010011, 2.022092,
 2.034139, 2.046151, 2.058129, 2.070072, 2.081982,
 2.093857, 2.105698, 2.117504, 2.129277, 2.141016,
 2.152720, 2.164390, 2.176027, 2.187629, 2.199197,
 2.210731, 2.222232, 2.233698, 2.245131, 2.256530,
 2.267895, 2.279226, 2.290523, 2.301787, 2.313017,
 2.324213, 2.335376, 2.346505, 2.357600, 2.368662,
 2.379690, 2.390685, 2.401646, 2.412574, 2.423468,
 2.434329, 2.445156, 2.455950, 2.466711, 2.477438,
 2.488133, 2.498793, 2.509421, 2.520015, 2.530577,
 2.541105, 2.551600, 2.562061, 2.572490, 2.582886,
 2.593248, 2.603578, 2.613874, 2.624138, 2.634369,
 2.644567, 2.654731, 2.664863, 2.674963, 2.685029,
 2.695063, 2.705063, 2.715032, 2.724967, 2.734870,
 2.744740, 2.754577, 2.764382, 2.774154, 2.783894,
 2.793601, 2.803276, 2.812918, 2.822528, 2.832105,
 2.841650, 2.851162, 2.860642, 2.870090, 2.879505,
 2.888888, 2.898239, 2.907558, 2.916844, 2.926098,
 2.935320, 2.944510, 2.953668, 2.962794, 2.971887,
 2.980949, 2.989978, 2.998976, 3.007941, 3.016875,
 3.025777, 3.034646, 3.043484, 3.052290, 3.061064,
 3.069807, 3.078517, 3.087196, 3.095843, 3.104458,
 3.113042, 3.121594, 3.130114, 3.138603, 3.147060,
 3.155485, 3.163879, 3.172242, 3.180573, 3.188872,
 3.197140, 3.205376, 3.213582, 3.221755, 3.229898,
 3.238009, 3.246088, 3.254136, 3.262154, 3.270139,
 3.278094, 3.286017, 3.293909, 3.301770, 3.309600,
 3.317399, 3.325167, 3.332903, 3.340609, 3.348283,
 3.355927, 3.363539, 3.371121, 3.378671, 3.386191,
 3.393680, 3.401138, 3.408565, 3.415961, 3.423326,
 3.430661, 3.437965, 3.445238, 3.452480, 3.459692,
 3.466873, 3.474023, 3.481143, 3.488232, 3.495290,
 3.502318, 3.509316, 3.516283, 3.523219, 3.530125,
 3.537001, 3.543846, 3.550660, 3.557444, 3.564198,
 3.570922, 3.577615, 3.584278, 3.590910, 3.597513,
 3.604085, 3.610627, 3.617138, 3.623620, 3.630071,
 3.636492, 3.642883, 3.649244, 3.655575, 3.661876,
 3.668147, 3.674388, 3.680599, 3.686779, 3.692930,
 3.699051, 3.705143, 3.711204, 3.717235, 3.723237,
 3.729208, 3.735150, 3.741062, 3.746945, 3.752798,
 3.758620, 3.764414, 3.770177, 3.775911, 3.781616,
 3.787290, 3.792935, 3.798551, 3.804137, 3.809693,
 3.815220, 3.820718, 3.826186, 3.831624, 3.837034,
 3.842413, 3.847764, 3.853085, 3.858376, 3.863639,
 3.868872, 3.874075, 3.879250, 3.884395, 3.889511,
 3.894598, 3.899656, 3.904684, 3.909683, 3.914654,
 3.919595, 3.924507, 3.929390, 3.934244, 3.939069,
 3.943865, 3.948632, 3.953370, 3.958079, 3.962759,
 3.967410, 3.972032, 3.976626, 3.981190, 3.985726,
 3.990233, 3.994712, 3.999161, 4.003582, 4.007974,
 4.012337, 4.016672, 4.020978, 4.025255, 4.029504,
 4.033724, 4.037916, 4.042079, 4.046213, 4.050319,
 4.054396, 4.058445, 4.062466, 4.066458, 4.070421,
 4.074356, 4.078263, 4.082142, 4.085992, 4.089813,
 4.093607, 4.097372, 4.101109, 4.104817, 4.108498,
 4.112150, 4.115774, 4.119370, 4.122937, 4.126477,
 4.129988, 4.133471, 4.136926, 4.140353, 4.143753,
 4.147124, 4.150467, 4.153782, 4.157069, 4.160328,
 4.163559, 4.166762, 4.169938, 4.173085, 4.176205,
 4.179296, 4.182360, 4.185397, 4.188405, 4.191386,
 4.194339, 4.197264, 4.200161, 4.203031, 4.205873,
 4.208687, 4.211474, 4.214233, 4.216965, 4.219669,
 4.222346, 4.224994, 4.227616, 4.230210, 4.232776,
 4.235315, 4.237827, 4.240311, 4.242767, 4.245197,
 4.247598, 4.249973, 4.252320, 4.254640, 4.256932,
 4.259198, 4.261436, 4.263646, 4.265830, 4.267986,
 4.270115, 4.272217, 4.274292, 4.276340, 4.278360,
 4.280353, 4.282320, 4.284259, 4.286171, 4.288056,
 4.289914, 4.291746, 4.293550, 4.295327, 4.297077,
 4.298800, 4.300497, 4.302166, 4.303809, 4.305425,
 4.307013, 4.308575, 4.310111, 4.311619, 4.313101,
 4.314556, 4.315984, 4.317386, 4.318760, 4.320109,
 4.321430, 4.322725, 4.323993, 4.32523 };

static double SNR_DL_PARABOLIC_REFLECTOR_NBIoT_SAT[584] =
{		 -18.935708, -18.651561, -18.375168, -18.106109, -17.844001,
		 -17.588490, -17.339250, -17.095980, -16.858401, -16.626255,
		 -16.399302, -16.177317, -15.960092, -15.747432, -15.539155,
		 -15.335090, -15.135077, -14.938967, -14.746617, -14.557895,
		 -14.372676, -14.190840, -14.012277, -13.836881, -13.664552,
		 -13.495196, -13.328722, -13.165045, -13.004086, -12.845766,
		 -12.690013, -12.536757, -12.385933, -12.237477, -12.091328,
		 -11.947430, -11.805727, -11.666167, -11.528701, -11.393279,
		 -11.259857, -11.128389, -10.998835, -10.871154, -10.745307,
		 -10.621258, -10.498969, -10.378408, -10.259542, -10.142339,
		 -10.026768, -9.912802, -9.800411, -9.689568, -9.580249,
		 -9.472427, -9.366079, -9.261182, -9.157714, -9.055653,
		 -8.954978, -8.855670, -8.757709, -8.661077, -8.565757,
		 -8.471731, -8.378982, -8.287494, -8.197253, -8.108243,
		 -8.020451, -7.933862, -7.848463, -7.764241, -7.681184,
		 -7.599281, -7.518519, -7.438889, -7.360378, -7.282978,
		 -7.206678, -7.131468, -7.057341, -6.984286, -6.912297,
		 -6.841364, -6.771480, -6.702638, -6.634830, -6.568050,
		 -6.502292, -6.437549, -6.373815, -6.311085, -6.249354,
		 -6.188616, -6.128866, -6.070101, -6.012315, -5.955505,
		 -5.899667, -5.844798, -5.790893, -5.737951, -5.685968,
		 -5.634942, -5.584870, -5.535750, -5.487580, -5.440359,
		 -5.394085, -5.348757, -5.304373, -5.260933, -5.218437,
		 -5.176884, -5.136273, -5.096605, -5.057880, -5.020099,
		 -4.983262, -4.947370, -4.912425, -4.878427, -4.845379,
		 -4.813281, -4.782136, -4.751947, -4.722715, -4.694444,
		 -4.667136, -4.640795, -4.615423, -4.591025, -4.567605,
		 -4.545166, -4.523713, -4.503251, -4.483784, -4.465318,
		 -4.447858, -4.431409, -4.415979, -4.401573, -4.388197,
		 -4.375859, -4.364566, -4.354325, -4.345145, -4.337032,
		 -4.329996, -4.324046, -4.319191, -4.315440, -4.312804,
		 -4.311292, -4.310916, -4.311687, -4.313616, -4.316715,
		 -4.320997, -4.326475, -4.333163, -4.341073, -4.350222,
		 -4.360623, -4.372293, -4.385248, -4.399504, -4.415079,
		 -4.431991, -4.450259, -4.469902, -4.490941, -4.513396,
		 -4.537290, -4.562644, -4.589484, -4.617832, -4.647714,
		 -4.679157, -4.712189, -4.746837, -4.783131, -4.821103,
		 -4.860784, -4.902207, -4.945408, -4.990424, -5.037290,
		 -5.086048, -5.136738, -5.189404, -5.244090, -5.300842,
		 -5.359711, -5.420746, -5.484002, -5.549536, -5.617404,
		 -5.687670, -5.760398, -5.835655, -5.913514, -5.994048,
		 -6.077336, -6.163462, -6.252512, -6.344580, -6.439761,
		 -6.538159, -6.639882, -6.745045, -6.853770, -6.966186,
		 -7.082430, -7.202647, -7.326993, -7.455632, -7.588742,
		 -7.726510, -7.869137, -8.016841, -8.169853, -8.328421,
		 -8.492815, -8.663324, -8.840262, -9.023968, -9.214810,
		 -9.413189, -9.619543, -9.834350, -10.058134, -10.291473,
		 -10.535004, -10.789430, -11.055535, -11.334191, -11.626377,
		 -11.933190, -12.255873, -12.595837, -12.954693, -13.334293,
		 -13.736781, -14.164655, -14.620853, -15.108861, -15.632857,
		 -16.197910, -16.810249, -17.477653, -18.210005, -19.020128,
		 -19.925085, -20.948279, -22.123040, -23.499189, -25.156095,
		 -27.231952, -30.001646, -34.150894, -42.536023, -46.363453,
		 -35.282281, -30.528765, -27.446678, -25.155442, -23.327209,
		 -21.803439, -20.495274, -19.347869, -18.324987, -17.401424,
		 -16.558944, -15.783923, -15.065916, -14.396738, -13.769856,
		 -13.179972, -12.622729, -12.094503, -11.592246, -11.113368,
		 -10.655653, -10.217189, -9.796314, -9.391576, -9.001695,
		 -8.625543, -8.262115, -7.910517, -7.569945, -7.239677,
		 -6.919062, -6.607508, -6.304479, -6.009485, -5.722080,
		 -5.441852, -5.168427, -4.901456, -4.640620, -4.385623,
		 -4.136190, -3.892068, -3.653018, -3.418821, -3.189270,
		 -2.964173, -2.743350, -2.526631, -2.313858, -2.104883,
		 -1.899564, -1.697769, -1.499375, -1.304262, -1.112321,
		 -0.923444, -0.737533, -0.554493, -0.374234, -0.196671,
		 -0.021721, 0.150691, 0.320639, 0.488194, 0.653422,
		 0.816388, 0.977152, 1.135773, 1.292306, 1.446805,
		 1.599320, 1.749902, 1.898597, 2.045449, 2.190503,
		 2.333800, 2.475379, 2.615280, 2.753540, 2.890193,
		 3.025274, 3.158817, 3.290852, 3.421411, 3.550524,
		 3.678218, 3.804523, 3.929463, 4.053065, 4.175354,
		 4.296354, 4.416089, 4.534580, 4.651850, 4.767920,
		 4.882810, 4.996540, 5.109130, 5.220598, 5.330962,
		 5.440240, 5.548448, 5.655604, 5.761724, 5.866823,
		 5.970916, 6.074018, 6.176143, 6.277306, 6.377519,
		 6.476797, 6.575152, 6.672596, 6.769142, 6.864802,
		 6.959586, 7.053507, 7.146575, 7.238802, 7.330196,
		 7.420769, 7.510531, 7.599491, 7.687659, 7.775043,
		 7.861654, 7.947499, 8.032587, 8.116926, 8.200526,
		 8.283393, 8.365536, 8.446962, 8.527678, 8.607692,
		 8.687012, 8.765643, 8.843594, 8.920869, 8.997477,
		 9.073423, 9.148714, 9.223355, 9.297354, 9.370714,
		 9.443444, 9.515547, 9.587029, 9.657897, 9.728154,
		 9.797807, 9.866860, 9.935318, 10.003187, 10.070470,
		 10.137173, 10.203301, 10.268857, 10.333846, 10.398272,
		 10.462141, 10.525455, 10.588218, 10.650436, 10.712112,
		 10.773249, 10.833852, 10.893924, 10.953469, 11.012490,
		 11.070991, 11.128975, 11.186446, 11.243407, 11.299861,
		 11.355812, 11.411263, 11.466216, 11.520675, 11.574642,
		 11.628122, 11.681116, 11.733627, 11.785658, 11.837212,
		 11.888292, 11.938900, 11.989038, 12.038710, 12.087918,
		 12.136664, 12.184950, 12.232780, 12.280155, 12.327077,
		 12.373550, 12.419574, 12.465153, 12.510289, 12.554982,
		 12.599237, 12.643054, 12.686436, 12.729384, 12.771901,
		 12.813988, 12.855648, 12.896881, 12.937691, 12.978078,
		 13.018045, 13.057593, 13.096724, 13.135440, 13.173741,
		 13.211631, 13.249110, 13.286179, 13.322842, 13.359098,
		 13.394949, 13.430398, 13.465445, 13.500091, 13.534339,
		 13.568189, 13.601642, 13.634701, 13.667366, 13.699639,
		 13.731521, 13.763013, 13.794116, 13.824832, 13.855161,
		 13.885106, 13.914666, 13.943843, 13.972638, 14.001053,
		 14.029088, 14.056744, 14.084022, 14.110924, 14.137449,
		 14.163600, 14.189378, 14.214782, 14.239814, 14.264475,
		 14.288766, 14.312687, 14.336240, 14.359425, 14.382243,
		 14.404695, 14.426781, 14.448503, 14.469861, 14.490856,
		 14.511488, 14.531759, 14.551668, 14.571218, 14.590407,
		 14.609237, 14.627710, 14.645824, 14.663581, 14.680981,
		 14.698025, 14.714714, 14.731048, 14.747027, 14.762653,
		 14.777925, 14.792845, 14.807411, 14.821626, 14.835490,
		 14.849003, 14.862165, 14.874976, 14.887438, 14.899551,
		 14.911315, 14.922730, 14.933797, 14.944516, 14.954888,
		 14.964912, 14.974590, 14.983921, 14.992905, 15.001544,
		 15.009837, 15.017784, 15.025386, 15.032643, 15.039556,
		 15.046124, 15.052347, 15.058227, 15.063762, 15.068954,
		 15.073802, 15.078306, 15.082467, 15.086285, 15.089760,
		 15.092891, 15.095680, 15.098126, 15.100230, 15.101990,
		 15.103408, 15.104483, 15.105216, 15.10560
};

static double LB_UL_PATCH_NBIoT_SAT[584] =
{ -156.584656, -156.564100, -156.543585, -156.523113, -156.502683,
 -156.482295, -156.461949, -156.441645, -156.421383, -156.401163,
 -156.380985, -156.360849, -156.340754, -156.320702, -156.300691,
 -156.280722, -156.260794, -156.240908, -156.221064, -156.201261,
 -156.181499, -156.161779, -156.142101, -156.122464, -156.102868,
 -156.083313, -156.063799, -156.044327, -156.024896, -156.005505,
 -155.986156, -155.966848, -155.947581, -155.928355, -155.909169,
 -155.890025, -155.870921, -155.851858, -155.832835, -155.813854,
 -155.794913, -155.776012, -155.757152, -155.738333, -155.719554,
 -155.700815, -155.682117, -155.663459, -155.644841, -155.626264,
 -155.607727, -155.589230, -155.570773, -155.552356, -155.533979,
 -155.515643, -155.497346, -155.479089, -155.460872, -155.442695,
 -155.424558, -155.406460, -155.388403, -155.370385, -155.352406,
 -155.334467, -155.316568, -155.298709, -155.280888, -155.263108,
 -155.245366, -155.227664, -155.210002, -155.192379, -155.174795,
 -155.157250, -155.139744, -155.122278, -155.104851, -155.087462,
 -155.070113, -155.052803, -155.035532, -155.018300, -155.001106,
 -154.983952, -154.966836, -154.949759, -154.932721, -154.915722,
 -154.898761, -154.881839, -154.864955, -154.848110, -154.831304,
 -154.814536, -154.797806, -154.781115, -154.764462, -154.747848,
 -154.731272, -154.714734, -154.698234, -154.681773, -154.665350,
 -154.648964, -154.632617, -154.616309, -154.600038, -154.583805,
 -154.567610, -154.551453, -154.535333, -154.519252, -154.503209,
 -154.487203, -154.471235, -154.455305, -154.439412, -154.423557,
 -154.407740, -154.391960, -154.376217, -154.360513, -154.344845,
 -154.329216, -154.313623, -154.298068, -154.282550, -154.267070,
 -154.251627, -154.236221, -154.220852, -154.205520, -154.190226,
 -154.174968, -154.159748, -154.144565, -154.129418, -154.114309,
 -154.099237, -154.084201, -154.069203, -154.054241, -154.039316,
 -154.024428, -154.009576, -153.994761, -153.979983, -153.965242,
 -153.950537, -153.935869, -153.921237, -153.906642, -153.892083,
 -153.877561, -153.863075, -153.848625, -153.834212, -153.819835,
 -153.805495, -153.791191, -153.776923, -153.762691, -153.748495,
 -153.734335, -153.720212, -153.706125, -153.692073, -153.678058,
 -153.664079, -153.650135, -153.636228, -153.622356, -153.608520,
 -153.594720, -153.580956, -153.567228, -153.553535, -153.539878,
 -153.526257, -153.512671, -153.499121, -153.485607, -153.472128,
 -153.458684, -153.445277, -153.431904, -153.418567, -153.405266,
 -153.391999, -153.378768, -153.365573, -153.352413, -153.339287,
 -153.326198, -153.313143, -153.300124, -153.287139, -153.274190,
 -153.261276, -153.248397, -153.235553, -153.222744, -153.209969,
 -153.197230, -153.184526, -153.171857, -153.159222, -153.146622,
 -153.134057, -153.121527, -153.109032, -153.096571, -153.084145,
 -153.071753, -153.059396, -153.047074, -153.034787, -153.022533,
 -153.010315, -152.998131, -152.985981, -152.973866, -152.961785,
 -152.949738, -152.937726, -152.925748, -152.913805, -152.901895,
 -152.890020, -152.878179, -152.866372, -152.854600, -152.842861,
 -152.831157, -152.819487, -152.807850, -152.796248, -152.784680,
 -152.773145, -152.761645, -152.750179, -152.738746, -152.727347,
 -152.715982, -152.704651, -152.693354, -152.682090, -152.670860,
 -152.659664, -152.648501, -152.637372, -152.626277, -152.615215,
 -152.604187, -152.593192, -152.582231, -152.571303, -152.560409,
 -152.549548, -152.538721, -152.527927, -152.517166, -152.506438,
 -152.495744, -152.485083, -152.474456, -152.463861, -152.453300,
 -152.442772, -152.432277, -152.421816, -152.411387, -152.400991,
 -152.390629, -152.380299, -152.370003, -152.359739, -152.349508,
 -152.339310, -152.329146, -152.319013, -152.308914, -152.298848,
 -152.288814, -152.278813, -152.268845, -152.258910, -152.249007,
 -152.239137, -152.229300, -152.219495, -152.209723, -152.199983,
 -152.190276, -152.180601, -152.170959, -152.161349, -152.151772,
 -152.142227, -152.132715, -152.123235, -152.113787, -152.104372,
 -152.094989, -152.085638, -152.076319, -152.067033, -152.057779,
 -152.048557, -152.039367, -152.030209, -152.021083, -152.011990,
 -152.002928, -151.993899, -151.984901, -151.975936, -151.967002,
 -151.958100, -151.949231, -151.940393, -151.931587, -151.922813,
 -151.914070, -151.905360, -151.896681, -151.888034, -151.879419,
 -151.870835, -151.862283, -151.853763, -151.845274, -151.836817,
 -151.828392, -151.819998, -151.811635, -151.803304, -151.795005,
 -151.786737, -151.778500, -151.770295, -151.762122, -151.753979,
 -151.745868, -151.737789, -151.729740, -151.721723, -151.713738,
 -151.705783, -151.697860, -151.689967, -151.682106, -151.674277,
 -151.666478, -151.658710, -151.650974, -151.643268, -151.635594,
 -151.627950, -151.620338, -151.612756, -151.605206, -151.597686,
 -151.590197, -151.582739, -151.575312, -151.567916, -151.560551,
 -151.553216, -151.545912, -151.538639, -151.531397, -151.524185,
 -151.517004, -151.509854, -151.502734, -151.495645, -151.488586,
 -151.481558, -151.474561, -151.467594, -151.460658, -151.453752,
 -151.446876, -151.440031, -151.433217, -151.426433, -151.419679,
 -151.412955, -151.406262, -151.399599, -151.392967, -151.386364,
 -151.379792, -151.373250, -151.366739, -151.360257, -151.353806,
 -151.347385, -151.340994, -151.334633, -151.328302, -151.322001,
 -151.315730, -151.309489, -151.303278, -151.297097, -151.290946,
 -151.284825, -151.278734, -151.272673, -151.266642, -151.260640,
 -151.254668, -151.248727, -151.242814, -151.236932, -151.231079,
 -151.225256, -151.219463, -151.213700, -151.207966, -151.202261,
 -151.196587, -151.190942, -151.185326, -151.179740, -151.174184,
 -151.168657, -151.163159, -151.157691, -151.152253, -151.146843,
 -151.141464, -151.136113, -151.130792, -151.125501, -151.120238,
 -151.115005, -151.109802, -151.104627, -151.099482, -151.094366,
 -151.089279, -151.084221, -151.079193, -151.074194, -151.069223,
 -151.064282, -151.059370, -151.054487, -151.049633, -151.044808,
 -151.040012, -151.035245, -151.030507, -151.025798, -151.021118,
 -151.016467, -151.011845, -151.007251, -151.002686, -150.998151,
 -150.993644, -150.989165, -150.984716, -150.980295, -150.975903,
 -150.971540, -150.967205, -150.962899, -150.958622, -150.954373,
 -150.950153, -150.945961, -150.941798, -150.937664, -150.933558,
 -150.929481, -150.925432, -150.921411, -150.917419, -150.913456,
 -150.909520, -150.905614, -150.901735, -150.897885, -150.894063,
 -150.890270, -150.886505, -150.882768, -150.879060, -150.875379,
 -150.871727, -150.868103, -150.864507, -150.860940, -150.857400,
 -150.853889, -150.850406, -150.846951, -150.843523, -150.840124,
 -150.836753, -150.833410, -150.830095, -150.826808, -150.823549,
 -150.820318, -150.817115, -150.813939, -150.810792, -150.807672,
 -150.804580, -150.801516, -150.798480, -150.795472, -150.792491,
 -150.789538, -150.786613, -150.783716, -150.780846, -150.778004,
 -150.775189, -150.772403, -150.769643, -150.766912, -150.764208,
 -150.761531, -150.758882, -150.756261, -150.753667, -150.751101,
 -150.748562, -150.746050, -150.743566, -150.741110, -150.738680,
 -150.736279, -150.733904, -150.731557, -150.729237, -150.726944,
 -150.724679, -150.722441, -150.720230, -150.718047, -150.715891,
 -150.713762, -150.711660, -150.709585, -150.707537, -150.705517,
 -150.703523, -150.701557, -150.699618, -150.697706, -150.695821,
 -150.693963, -150.692131, -150.690327, -150.688550, -150.686800,
 -150.685077, -150.683380, -150.681711, -150.680068, -150.678452,
 -150.676863, -150.675301, -150.673766, -150.672258, -150.670776,
 -150.669321, -150.667893, -150.666491, -150.665117, -150.663768,
 -150.662447, -150.661152, -150.659884, -150.65864 };

static double LB_UL_PARABOLIC_REFLECTOR_NBIoT_SAT[584] =
{ -171.919585, -171.635438, -171.359044, -171.089986, -170.827878,
 -170.572366, -170.323127, -170.079857, -169.842278, -169.610132,
 -169.383179, -169.161194, -168.943969, -168.731309, -168.523032,
 -168.318967, -168.118954, -167.922844, -167.730494, -167.541772,
 -167.356553, -167.174717, -166.996154, -166.820758, -166.648429,
 -166.479073, -166.312599, -166.148922, -165.987963, -165.829643,
 -165.673890, -165.520634, -165.369810, -165.221354, -165.075205,
 -164.931307, -164.789604, -164.650044, -164.512578, -164.377156,
 -164.243734, -164.112266, -163.982712, -163.855031, -163.729184,
 -163.605135, -163.482846, -163.362285, -163.243419, -163.126216,
 -163.010645, -162.896679, -162.784287, -162.673445, -162.564126,
 -162.456304, -162.349956, -162.245059, -162.141591, -162.039530,
 -161.938855, -161.839547, -161.741586, -161.644954, -161.549634,
 -161.455607, -161.362859, -161.271371, -161.181130, -161.092120,
 -161.004328, -160.917739, -160.832339, -160.748118, -160.665061,
 -160.583158, -160.502396, -160.422766, -160.344255, -160.266855,
 -160.190555, -160.115345, -160.041218, -159.968163, -159.896174,
 -159.825241, -159.755357, -159.686515, -159.618707, -159.551927,
 -159.486169, -159.421426, -159.357692, -159.294962, -159.233231,
 -159.172492, -159.112743, -159.053978, -158.996192, -158.939382,
 -158.883544, -158.828675, -158.774770, -158.721828, -158.669845,
 -158.618819, -158.568747, -158.519627, -158.471457, -158.424236,
 -158.377962, -158.332633, -158.288250, -158.244810, -158.202314,
 -158.160760, -158.120150, -158.080482, -158.041757, -158.003976,
 -157.967139, -157.931247, -157.896302, -157.862304, -157.829255,
 -157.797158, -157.766013, -157.735824, -157.706592, -157.678321,
 -157.651013, -157.624672, -157.599300, -157.574902, -157.551482,
 -157.529043, -157.507590, -157.487128, -157.467661, -157.449195,
 -157.431734, -157.415286, -157.399856, -157.385450, -157.372074,
 -157.359736, -157.348443, -157.338202, -157.329021, -157.320909,
 -157.313873, -157.307923, -157.303068, -157.299317, -157.296681,
 -157.295169, -157.294793, -157.295564, -157.297493, -157.300592,
 -157.304874, -157.310352, -157.317040, -157.324950, -157.334099,
 -157.344500, -157.356170, -157.369124, -157.383381, -157.398956,
 -157.415868, -157.434135, -157.453779, -157.474817, -157.497273,
 -157.521166, -157.546521, -157.573360, -157.601709, -157.631591,
 -157.663034, -157.696066, -157.730714, -157.767008, -157.804980,
 -157.844661, -157.886084, -157.929285, -157.974300, -158.021167,
 -158.069925, -158.120615, -158.173281, -158.227966, -158.284719,
 -158.343587, -158.404623, -158.467879, -158.533413, -158.601281,
 -158.671547, -158.744275, -158.819532, -158.897391, -158.977925,
 -159.061213, -159.147339, -159.236389, -159.328457, -159.423638,
 -159.522036, -159.623759, -159.728922, -159.837647, -159.950063,
 -160.066307, -160.186524, -160.310870, -160.439509, -160.572619,
 -160.710386, -160.853014, -161.000718, -161.153729, -161.312298,
 -161.476692, -161.647201, -161.824139, -162.007845, -162.198687,
 -162.397066, -162.603420, -162.818227, -163.042011, -163.275350,
 -163.518881, -163.773307, -164.039412, -164.318068, -164.610254,
 -164.917067, -165.239750, -165.579714, -165.938570, -166.318170,
 -166.720658, -167.148532, -167.604730, -168.092738, -168.616734,
 -169.181787, -169.794126, -170.461530, -171.193882, -172.004005,
 -172.908962, -173.932156, -175.106917, -176.483066, -178.139972,
 -180.215829, -182.985523, -187.134771, -195.519900, -199.347330,
 -188.266158, -183.512642, -180.430555, -178.139319, -176.311086,
 -174.787316, -173.479150, -172.331746, -171.308864, -170.385301,
 -169.542820, -168.767800, -168.049793, -167.380615, -166.753733,
 -166.163849, -165.606606, -165.078380, -164.576123, -164.097245,
 -163.639530, -163.201066, -162.780191, -162.375452, -161.985572,
 -161.609420, -161.245992, -160.894394, -160.553822, -160.223554,
 -159.902939, -159.591385, -159.288356, -158.993362, -158.705956,
 -158.425729, -158.152303, -157.885333, -157.624497, -157.369500,
 -157.120067, -156.875945, -156.636895, -156.402698, -156.173147,
 -155.948050, -155.727226, -155.510508, -155.297735, -155.088759,
 -154.883441, -154.681646, -154.483252, -154.288139, -154.096198,
 -153.907321, -153.721410, -153.538370, -153.358111, -153.180548,
 -153.005598, -152.833186, -152.663238, -152.495683, -152.330454,
 -152.167489, -152.006725, -151.848104, -151.691571, -151.537072,
 -151.384557, -151.233975, -151.085280, -150.938428, -150.793374,
 -150.650077, -150.508497, -150.368597, -150.230337, -150.093684,
 -149.958603, -149.825060, -149.693025, -149.562466, -149.433353,
 -149.305658, -149.179354, -149.054414, -148.930812, -148.808523,
 -148.687523, -148.567788, -148.449297, -148.332027, -148.215957,
 -148.101067, -147.987337, -147.874747, -147.763279, -147.652915,
 -147.543637, -147.435429, -147.328273, -147.222153, -147.117054,
 -147.012961, -146.909859, -146.807734, -146.706571, -146.606357,
 -146.507080, -146.408725, -146.311281, -146.214735, -146.119075,
 -146.024291, -145.930370, -145.837302, -145.745075, -145.653681,
 -145.563107, -145.473346, -145.384386, -145.296218, -145.208834,
 -145.122223, -145.036378, -144.951290, -144.866950, -144.783351,
 -144.700484, -144.618341, -144.536915, -144.456199, -144.376184,
 -144.296865, -144.218234, -144.140283, -144.063008, -143.986400,
 -143.910454, -143.835163, -143.760522, -143.686523, -143.613163,
 -143.540433, -143.468330, -143.396848, -143.325980, -143.255723,
 -143.186070, -143.117017, -143.048559, -142.980690, -142.913407,
 -142.846704, -142.780576, -142.715020, -142.650031, -142.585605,
 -142.521736, -142.458422, -142.395658, -142.333441, -142.271765,
 -142.210628, -142.150025, -142.089953, -142.030408, -141.971387,
 -141.912886, -141.854902, -141.797431, -141.740470, -141.684015,
 -141.628065, -141.572614, -141.517661, -141.463202, -141.409234,
 -141.355755, -141.302761, -141.250250, -141.198219, -141.146665,
 -141.095585, -141.044977, -140.994839, -140.945167, -140.895959,
 -140.847213, -140.798927, -140.751097, -140.703722, -140.656800,
 -140.610327, -140.564303, -140.518724, -140.473588, -140.428895,
 -140.384640, -140.340823, -140.297441, -140.254493, -140.211976,
 -140.169889, -140.128229, -140.086996, -140.046186, -140.005799,
 -139.965832, -139.926284, -139.887153, -139.848437, -139.810135,
 -139.772246, -139.734767, -139.697697, -139.661035, -139.624779,
 -139.588928, -139.553479, -139.518432, -139.483786, -139.449538,
 -139.415688, -139.382235, -139.349176, -139.316510, -139.284238,
 -139.252356, -139.220864, -139.189761, -139.159045, -139.128715,
 -139.098771, -139.069211, -139.040034, -139.011239, -138.982824,
 -138.954789, -138.927133, -138.899855, -138.872953, -138.846427,
 -138.820276, -138.794499, -138.769095, -138.744063, -138.719402,
 -138.695111, -138.671190, -138.647637, -138.624452, -138.601634,
 -138.579182, -138.557096, -138.535374, -138.514016, -138.493021,
 -138.472389, -138.452118, -138.432209, -138.412659, -138.393470,
 -138.374639, -138.356167, -138.338053, -138.320296, -138.302896,
 -138.285852, -138.269163, -138.252829, -138.236849, -138.221224,
 -138.205952, -138.191032, -138.176465, -138.162250, -138.148387,
 -138.134874, -138.121712, -138.108901, -138.096438, -138.084326,
 -138.072562, -138.061147, -138.050080, -138.039361, -138.028989,
 -138.018965, -138.009287, -137.999956, -137.990972, -137.982333,
 -137.974040, -137.966093, -137.958491, -137.951233, -137.944321,
 -137.937753, -137.931530, -137.925650, -137.920115, -137.914923,
 -137.910075, -137.905571, -137.901410, -137.897592, -137.894117,
 -137.890985, -137.888197, -137.885751, -137.883647, -137.881887,
 -137.880469, -137.879394, -137.878661, -137.87826
};


static double ELANGLE_NBIoT_SAT[584] =
{ 55.000000, 55.060000, 55.120000, 55.180000, 55.240000,
 55.300000, 55.360000, 55.420000, 55.480000, 55.540000,
 55.600000, 55.660000, 55.720000, 55.780000, 55.840000,
 55.900000, 55.960000, 56.020000, 56.080000, 56.140000,
 56.200000, 56.260000, 56.320000, 56.380000, 56.440000,
 56.500000, 56.560000, 56.620000, 56.680000, 56.740000,
 56.800000, 56.860000, 56.920000, 56.980000, 57.040000,
 57.100000, 57.160000, 57.220000, 57.280000, 57.340000,
 57.400000, 57.460000, 57.520000, 57.580000, 57.640000,
 57.700000, 57.760000, 57.820000, 57.880000, 57.940000,
 58.000000, 58.060000, 58.120000, 58.180000, 58.240000,
 58.300000, 58.360000, 58.420000, 58.480000, 58.540000,
 58.600000, 58.660000, 58.720000, 58.780000, 58.840000,
 58.900000, 58.960000, 59.020000, 59.080000, 59.140000,
 59.200000, 59.260000, 59.320000, 59.380000, 59.440000,
 59.500000, 59.560000, 59.620000, 59.680000, 59.740000,
 59.800000, 59.860000, 59.920000, 59.980000, 60.040000,
 60.100000, 60.160000, 60.220000, 60.280000, 60.340000,
 60.400000, 60.460000, 60.520000, 60.580000, 60.640000,
 60.700000, 60.760000, 60.820000, 60.880000, 60.940000,
 61.000000, 61.060000, 61.120000, 61.180000, 61.240000,
 61.300000, 61.360000, 61.420000, 61.480000, 61.540000,
 61.600000, 61.660000, 61.720000, 61.780000, 61.840000,
 61.900000, 61.960000, 62.020000, 62.080000, 62.140000,
 62.200000, 62.260000, 62.320000, 62.380000, 62.440000,
 62.500000, 62.560000, 62.620000, 62.680000, 62.740000,
 62.800000, 62.860000, 62.920000, 62.980000, 63.040000,
 63.100000, 63.160000, 63.220000, 63.280000, 63.340000,
 63.400000, 63.460000, 63.520000, 63.580000, 63.640000,
 63.700000, 63.760000, 63.820000, 63.880000, 63.940000,
 64.000000, 64.060000, 64.120000, 64.180000, 64.240000,
 64.300000, 64.360000, 64.420000, 64.480000, 64.540000,
 64.600000, 64.660000, 64.720000, 64.780000, 64.840000,
 64.900000, 64.960000, 65.020000, 65.080000, 65.140000,
 65.200000, 65.260000, 65.320000, 65.380000, 65.440000,
 65.500000, 65.560000, 65.620000, 65.680000, 65.740000,
 65.800000, 65.860000, 65.920000, 65.980000, 66.040000,
 66.100000, 66.160000, 66.220000, 66.280000, 66.340000,
 66.400000, 66.460000, 66.520000, 66.580000, 66.640000,
 66.700000, 66.760000, 66.820000, 66.880000, 66.940000,
 67.000000, 67.060000, 67.120000, 67.180000, 67.240000,
 67.300000, 67.360000, 67.420000, 67.480000, 67.540000,
 67.600000, 67.660000, 67.720000, 67.780000, 67.840000,
 67.900000, 67.960000, 68.020000, 68.080000, 68.140000,
 68.200000, 68.260000, 68.320000, 68.380000, 68.440000,
 68.500000, 68.560000, 68.620000, 68.680000, 68.740000,
 68.800000, 68.860000, 68.920000, 68.980000, 69.040000,
 69.100000, 69.160000, 69.220000, 69.280000, 69.340000,
 69.400000, 69.460000, 69.520000, 69.580000, 69.640000,
 69.700000, 69.760000, 69.820000, 69.880000, 69.940000,
 70.000000, 70.060000, 70.120000, 70.180000, 70.240000,
 70.300000, 70.360000, 70.420000, 70.480000, 70.540000,
 70.600000, 70.660000, 70.720000, 70.780000, 70.840000,
 70.900000, 70.960000, 71.020000, 71.080000, 71.140000,
 71.200000, 71.260000, 71.320000, 71.380000, 71.440000,
 71.500000, 71.560000, 71.620000, 71.680000, 71.740000,
 71.800000, 71.860000, 71.920000, 71.980000, 72.040000,
 72.100000, 72.160000, 72.220000, 72.280000, 72.340000,
 72.400000, 72.460000, 72.520000, 72.580000, 72.640000,
 72.700000, 72.760000, 72.820000, 72.880000, 72.940000,
 73.000000, 73.060000, 73.120000, 73.180000, 73.240000,
 73.300000, 73.360000, 73.420000, 73.480000, 73.540000,
 73.600000, 73.660000, 73.720000, 73.780000, 73.840000,
 73.900000, 73.960000, 74.020000, 74.080000, 74.140000,
 74.200000, 74.260000, 74.320000, 74.380000, 74.440000,
 74.500000, 74.560000, 74.620000, 74.680000, 74.740000,
 74.800000, 74.860000, 74.920000, 74.980000, 75.040000,
 75.100000, 75.160000, 75.220000, 75.280000, 75.340000,
 75.400000, 75.460000, 75.520000, 75.580000, 75.640000,
 75.700000, 75.760000, 75.820000, 75.880000, 75.940000,
 76.000000, 76.060000, 76.120000, 76.180000, 76.240000,
 76.300000, 76.360000, 76.420000, 76.480000, 76.540000,
 76.600000, 76.660000, 76.720000, 76.780000, 76.840000,
 76.900000, 76.960000, 77.020000, 77.080000, 77.140000,
 77.200000, 77.260000, 77.320000, 77.380000, 77.440000,
 77.500000, 77.560000, 77.620000, 77.680000, 77.740000,
 77.800000, 77.860000, 77.920000, 77.980000, 78.040000,
 78.100000, 78.160000, 78.220000, 78.280000, 78.340000,
 78.400000, 78.460000, 78.520000, 78.580000, 78.640000,
 78.700000, 78.760000, 78.820000, 78.880000, 78.940000,
 79.000000, 79.060000, 79.120000, 79.180000, 79.240000,
 79.300000, 79.360000, 79.420000, 79.480000, 79.540000,
 79.600000, 79.660000, 79.720000, 79.780000, 79.840000,
 79.900000, 79.960000, 80.020000, 80.080000, 80.140000,
 80.200000, 80.260000, 80.320000, 80.380000, 80.440000,
 80.500000, 80.560000, 80.620000, 80.680000, 80.740000,
 80.800000, 80.860000, 80.920000, 80.980000, 81.040000,
 81.100000, 81.160000, 81.220000, 81.280000, 81.340000,
 81.400000, 81.460000, 81.520000, 81.580000, 81.640000,
 81.700000, 81.760000, 81.820000, 81.880000, 81.940000,
 82.000000, 82.060000, 82.120000, 82.180000, 82.240000,
 82.300000, 82.360000, 82.420000, 82.480000, 82.540000,
 82.600000, 82.660000, 82.720000, 82.780000, 82.840000,
 82.900000, 82.960000, 83.020000, 83.080000, 83.140000,
 83.200000, 83.260000, 83.320000, 83.380000, 83.440000,
 83.500000, 83.560000, 83.620000, 83.680000, 83.740000,
 83.800000, 83.860000, 83.920000, 83.980000, 84.040000,
 84.100000, 84.160000, 84.220000, 84.280000, 84.340000,
 84.400000, 84.460000, 84.520000, 84.580000, 84.640000,
 84.700000, 84.760000, 84.820000, 84.880000, 84.940000,
 85.000000, 85.060000, 85.120000, 85.180000, 85.240000,
 85.300000, 85.360000, 85.420000, 85.480000, 85.540000,
 85.600000, 85.660000, 85.720000, 85.780000, 85.840000,
 85.900000, 85.960000, 86.020000, 86.080000, 86.140000,
 86.200000, 86.260000, 86.320000, 86.380000, 86.440000,
 86.500000, 86.560000, 86.620000, 86.680000, 86.740000,
 86.800000, 86.860000, 86.920000, 86.980000, 87.040000,
 87.100000, 87.160000, 87.220000, 87.280000, 87.340000,
 87.400000, 87.460000, 87.520000, 87.580000, 87.640000,
 87.700000, 87.760000, 87.820000, 87.880000, 87.940000,
 88.000000, 88.060000, 88.120000, 88.180000, 88.240000,
 88.300000, 88.360000, 88.420000, 88.480000, 88.540000,
 88.600000, 88.660000, 88.720000, 88.780000, 88.840000,
 88.900000, 88.960000, 89.020000, 89.080000, 89.140000,
 89.200000, 89.260000, 89.320000, 89.380000, 89.440000,
 89.500000, 89.560000, 89.620000, 89.680000, 89.740000,
 89.800000, 89.860000, 89.920000, 89.98000
};


static double
CodeRatesSingleToneTable [11][5] =
		// IRU	0 -> 4
		// ITBS	0 -> 10
{
		{0.21, 	0.15,	0.14,	0.15,	0.15},
		{0.26,	0.21,	0.20,	0.20,	0.23},
		{0.29,	0.26,	0.29,	0.26,	0.24},
		{0.33,	0.33,	0.35,	0.30,	0.29},
		{0.42,	0.38,	0.41,	0.36,	0.36},
		{0.50,	0.44,	0.44,	0.47,	0.47},
		{0.59,	0.53,	0.48,	0.54,	0.56},
		{0.66,	0.65,	0.62,	0.65,	0.63},
		{0.75,	0.74,	0.72,	0.74,	0.74},
		{0.84,	0.84,	0.84,	0.84,	0.84},
		{0.87,	0.92,	0.92,	0.92,	0.93},
};

static double
RefCodeRates[5] =
{
	0.18, 0.29, 0.36, 0.48, 0.74
};

static int
RefMCS[5]=
{
		1, 3, 4, 6, 8
};

static int
RefNRU[5]=
{
		8, 5, 4, 3, 2
};

static double
GetBLER_SAT (double SINR, int MCS)
{
  int index = -1;
  double BLER = 0.0;
  int MCS_ = MCS;
  double R = 0.0;
  int _NRep = FrameManager::Init()->GetNRep();

  if(_NRep == 2 )
  {
	  MCS_ = MCS_ + 9;
  }
  else if(_NRep == 4)
  {
	  MCS_ = MCS_ + 18;
  }

  if ( SINR <= SINR4BLER_NBIoT_SAT [MCS_] [0] )
    {
      BLER = 1.0;
    }
  else if (SINR >= SINR4BLER_NBIoT_SAT [MCS_] [20])
    {
      BLER = 0.0;
    }
  else
    {
      for (int i=0; i<20; i++)
        {
          if (SINR >= SINR4BLER_NBIoT_SAT [MCS_] [i] && SINR < SINR4BLER_NBIoT_SAT [MCS_] [i+1])
            {
              index = i;
            }
        }
    }

  if (index != -1)
    {
      R = (SINR - SINR4BLER_NBIoT_SAT [MCS_] [index]) / ( SINR4BLER_NBIoT_SAT [MCS_] [index + 1] - SINR4BLER_NBIoT_SAT [MCS_] [index] );
      BLER = BLER_NBIoT_SAT [MCS_] [index] + R * ( BLER_NBIoT_SAT [MCS_] [index + 1] - BLER_NBIoT_SAT [MCS_] [index] );
    }

DEBUG_LOG_START_1(SIM_ENV_BLER_DEBUG)
	cout << endl;
	cout << "Selected BLER curve: "<<endl;
	for(int k=0;k<21;k++){
		cout << BLER_NBIoT_SAT [MCS_][k] << " - ";
	}
	cout << endl;
DEBUG_LOG_END

  if (BLER >= 0.1)
    {
DEBUG_LOG_START_1(SIM_ENV_BLER_DEBUG)
      cout << "SINR " << SINR << " "
                << "CQI " << MCS_ << " "
                << "SINRprec " << SINR4BLER_NBIoT_SAT [MCS_-1] [index] << " "
                << "SINRsucc " << SINR4BLER_NBIoT_SAT [MCS_-1] [index+1] << " "
                << "BLERprec " << BLER_NBIoT_SAT [MCS_-1] [index] << " "
                << "BLERsucc " << BLER_NBIoT_SAT [MCS_-1] [index + 1] << " "
                << "R " << R << " "
                << "BLER " << BLER << " "
                << endl;
DEBUG_LOG_END
    }
  return BLER;
}

static double GetCellSelectionProb(double snr){
	double CellSelectionProb = 0.0;
	int index = -1;
	double R = 0.0;

	if ( snr <= SINR4CELLSELECTION_NBIoT_SAT [0] )
	    {
			CellSelectionProb = 0.0;
	    }
	  else if (snr >= SINR4CELLSELECTION_NBIoT_SAT [41])
	    {
		  	CellSelectionProb = 1.0;
	    }
	  else
	    {
	      for (int i=0; i<42; i++)
	        {
	          if (snr >= SINR4CELLSELECTION_NBIoT_SAT [i] && snr < SINR4CELLSELECTION_NBIoT_SAT [i+1])
	            {
	              index = i;
	            }
	        }
	    }

	  if (index != -1)
	    {
	      R = (snr - SINR4CELLSELECTION_NBIoT_SAT [index]) / (SINR4CELLSELECTION_NBIoT_SAT [index + 1] - SINR4CELLSELECTION_NBIoT_SAT [index]);
	      CellSelectionProb = CELLSELECTIONPROB_NBIoT_SAT [index] + R * ( CELLSELECTIONPROB_NBIoT_SAT [index + 1] - CELLSELECTIONPROB_NBIoT_SAT [index] );
	    }


	return CellSelectionProb;
}

static double
GetSNRfromElAngle_SAT (double elangle, int uplink_or_downlink, SatelliteMovement::AntennaType model) // 1 - uplink, 2 - downlink
{
  int index = -1;
  double R = 0.0;
  double measuredSNR = 0.0;

  if ( elangle <= ELANGLE_NBIoT_SAT [0] )
    {
      measuredSNR = -999999.0;
    }
  else if (elangle >= ELANGLE_NBIoT_SAT [583])
    {
	  if (uplink_or_downlink == 1){
          if(model == SatelliteMovement::PATCH_ANTENNA)
              measuredSNR = SNR_UL_PATCH_NBIoT_SAT [583];
          else
              measuredSNR = SNR_UL_PARABOLIC_REFLECTOR_NBIoT_SAT [583];
	  }else{
          if(model == SatelliteMovement::PATCH_ANTENNA)
              measuredSNR = SNR_DL_PATCH_NBIoT_SAT [583];
          else
              measuredSNR = SNR_DL_PARABOLIC_REFLECTOR_NBIoT_SAT [583];
	  }
    }
  else
    {
      for (int i=0; i<583; i++)
        {
          if (elangle >= ELANGLE_NBIoT_SAT [i] && elangle < ELANGLE_NBIoT_SAT [i+1])
            {
              index = i;
            }
        }
    }

  if (index != -1)
    {
      R = (elangle - ELANGLE_NBIoT_SAT [index]) / ( ELANGLE_NBIoT_SAT [index + 1] - ELANGLE_NBIoT_SAT [index] );

      if (uplink_or_downlink == 1){
    	  if(model == SatelliteMovement::PARABOLIC_REFLECTOR){

    		  measuredSNR = SNR_UL_PARABOLIC_REFLECTOR_NBIoT_SAT [index] + R * ( SNR_UL_PARABOLIC_REFLECTOR_NBIoT_SAT [index + 1] - SNR_UL_PARABOLIC_REFLECTOR_NBIoT_SAT [index] );

    	  }else if(model == SatelliteMovement::PATCH_ANTENNA){

    		  measuredSNR = SNR_UL_PATCH_NBIoT_SAT [index] + R * ( SNR_UL_PATCH_NBIoT_SAT [index + 1] - SNR_UL_PATCH_NBIoT_SAT [index] );

    	  }

      }else{
    	  if(model == SatelliteMovement::PARABOLIC_REFLECTOR){

    		  measuredSNR = SNR_DL_PARABOLIC_REFLECTOR_NBIoT_SAT [index] + R * ( SNR_DL_PARABOLIC_REFLECTOR_NBIoT_SAT [index + 1] - SNR_DL_PARABOLIC_REFLECTOR_NBIoT_SAT [index] );

    	  }else if(model == SatelliteMovement::PATCH_ANTENNA){

    		  measuredSNR = SNR_DL_PATCH_NBIoT_SAT [index] + R * ( SNR_DL_PATCH_NBIoT_SAT [index + 1] - SNR_DL_PATCH_NBIoT_SAT [index] );

    	  }

      }

    }
  return measuredSNR;
}

static double
GetRxPowerfromElAngle_SAT (double elangle, SatelliteMovement::AntennaType model)
{
	  int index = -1;
	  double R = 0.0;
	  double rxPower = 0.0;

	  if ( elangle <= ELANGLE_NBIoT_SAT [0] )
	    {
		  rxPower = -999999.0;
	    }
	  else if (elangle >= ELANGLE_NBIoT_SAT [583])
	    {
		  rxPower = ELANGLE_NBIoT_SAT [583];
	    }
	  else
	    {
	      for (int i=0; i<583; i++)
	        {
	          if (elangle >= ELANGLE_NBIoT_SAT [i] && elangle < ELANGLE_NBIoT_SAT [i+1])
	            {
	              index = i;
	            }
	        }
	    }

	  if (index != -1)
	    {
	      R = (elangle - ELANGLE_NBIoT_SAT [index]) / ( ELANGLE_NBIoT_SAT [index + 1] - ELANGLE_NBIoT_SAT [index] );
	      if(model == SatelliteMovement::PARABOLIC_REFLECTOR){

	    	  rxPower = LB_UL_PARABOLIC_REFLECTOR_NBIoT_SAT [index] + R * ( LB_UL_PARABOLIC_REFLECTOR_NBIoT_SAT [index + 1] - LB_UL_PARABOLIC_REFLECTOR_NBIoT_SAT [index] );

	      }else if(model == SatelliteMovement::PATCH_ANTENNA){

	    	  rxPower = LB_UL_PATCH_NBIoT_SAT [index] + R * ( LB_UL_PATCH_NBIoT_SAT [index + 1] - LB_UL_PATCH_NBIoT_SAT [index] );

	      }


	    }
	  return rxPower;
}

static double
GetMinElAngleFromSNR (double minSNR, int uplink_or_downlink, SatelliteMovement::AntennaType model)  { // 1 - uplink, 2 - downlink)
    int index = -1;
    double measuredSNR[584];
    
    if (uplink_or_downlink == 1){
        if(model == SatelliteMovement::PATCH_ANTENNA)
            for (int i=0; i<583; i++)
        measuredSNR[i] = SNR_UL_PATCH_NBIoT_SAT[i];
        else
            for (int i=0; i<583; i++)
        measuredSNR[i] = SNR_UL_PARABOLIC_REFLECTOR_NBIoT_SAT[i];
    }
    else{
        if(model == SatelliteMovement::PATCH_ANTENNA)
            for (int i=0; i<583; i++)
        measuredSNR[i] = SNR_DL_PATCH_NBIoT_SAT[i];
        else
            for (int i=0; i<583; i++)
        measuredSNR[i] = SNR_DL_PARABOLIC_REFLECTOR_NBIoT_SAT[i];
    }
    
    for (int i=0; i<583; i++) {
        if (minSNR >= measuredSNR[i]) {
            index = i;
            break;
        }
    }
    if (index!=-1)
        return ELANGLE_NBIoT_SAT [index];
    else
        return 90.0;
}


/*static double
GetMinDistance4CellSelection(){
	return 518800.0; // relativo all'angolo di elevazione 74.5
}*/

#endif /* BLERVSSINR_NBIoT_SAT_H */
